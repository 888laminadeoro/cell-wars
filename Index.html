<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
<title>Cell Wars</title>
<style>
*{margin:0;padding:0;overflow:hidden}body{background:#000}canvas{display:block;width:100vw;height:100vh}
</style>
</head>
<body>
<canvas id="c"></canvas>
<script>
const c = document.getElementById('c'), ctx = c.getContext('2d');
c.width = innerWidth; c.height = innerHeight;
class V{constructor(x,y){this.x=x;this.y=y}add(v){return new V(this.x+v.x,this.y+v.y)}sub(v){return new V(this.x-v.x,this.y-v.y)}mul(n){return new V(this.x*n,this.y*n)}mag(){return Math.sqrt(this.x**2+this.y**2)}norm(){const m=this.mag();return m>0?new V(this.x/m,this.y/m):new V(0,0)}dist(v){return this.sub(v).mag()}}
let player={pos:new V(500,500),vel:new V(0,0),mass:10,color:'#0ff'};
let cells=[],food=[],enemies=[];
for(let i=0;i<300;i++)food.push({pos:new V(Math.random()*1000,Math.random()*1000),mass:1,color:'#ff0'});
for(let i=0;i<15;i++)enemies.push({pos:new V(Math.random()*1000,Math.random()*1000),vel:new V(0,0),mass:8+Math.random()*10,color:'#f00',target:null});
let mx=c.width/2, my=c.height/2;
c.addEventListener('mousemove',e=>{mx=e.clientX;my=e.clientY});
c.addEventListener('touchmove',e=>{mx=e.touches[0].clientX;my=e.touches[0].clientY});
function r(){ctx.fillStyle='#000';ctx.fillRect(0,0,c.width,c.height);let cx=player.pos.x-c.width/2,cy=player.pos.y-c.height/2;ctx.fillStyle='#333';for(let x=Math.floor(cx/50)*50;x<cx+c.width;x+=50){ctx.fillRect(x-cx,0,1,c.height)}for(let y=Math.floor(cy/50)*50;y<cy+c.height;y+=50){ctx.fillRect(0,y-cy,c.width,1)}
food.forEach(f=>{let x=f.pos.x-cx,y=f.pos.y-cy;if(x>-10&&x<c.width&&y>-10&&y<c.height){ctx.fillStyle=f.color;ctx.beginPath();ctx.arc(x,y,2,0,7)}});
enemies.forEach(e=>{let x=e.pos.x-cx,y=e.pos.y-cy;if(x>-20&&x<c.width&&y>-20&&y<c.height){ctx.fillStyle=e.color;ctx.beginPath();ctx.arc(x,y,Math.sqrt(e.mass)*2,0,7);ctx.fill()}});
let r2=Math.sqrt(player.mass)*2;ctx.fillStyle=player.color;ctx.beginPath();ctx.arc(c.width/2,c.height/2,r2,0,7);ctx.fill();ctx.strokeStyle='#0ff';ctx.lineWidth=2;ctx.stroke();
ctx.fillStyle='#fff';ctx.font='20px Arial';ctx.fillText('Masa: '+Math.floor(player.mass),20,40);ctx.fillText('Comidas: '+food.length,20,70)}
function u(){let dir=new V(mx-c.width/2,my-c.height/2).norm(),speed=300/Math.sqrt(player.mass);player.vel=dir.mul(speed*0.016);player.pos=player.pos.add(player.vel);
for(let i=food.length-1;i>=0;i--){if(player.pos.dist(food[i].pos)<Math.sqrt(player.mass)*2+2){player.mass+=food[i].mass;food.splice(i,1)}}
enemies.forEach(e=>{let d=Math.random()*1000;if(d<400){let p=food.find(f=>e.pos.dist(f.pos)<200);if(p)e.target=p}let t=e.target||{pos:new V(Math.random()*1000,Math.random()*1000)};let dir=t.pos.sub(e.pos).norm(),s=200/Math.sqrt(e.mass)*0.016;e.vel=e.vel.mul(0.95).add(dir.mul(s));e.pos=e.pos.add(e.vel);
for(let i=food.length-1;i>=0;i--){if(e.pos.dist(food[i].pos)<Math.sqrt(e.mass)*2+2){e.mass+=food[i].mass;food.splice(i,1);break}}
if(player.pos.dist(e.pos)<r2+Math.sqrt(e.mass)*2&&player.mass>e.mass*1.1){player.mass+=e.mass;enemies.splice(enemies.indexOf(e),1)}else if(player.pos.dist(e.pos)<r2+Math.sqrt(e.mass)*2&&e.mass>player.mass*1.1){alert('Game Over! Masa: '+Math.floor(player.mass));location.reload()}});
if(food.length<150)for(let i=0;i<30;i++)food.push({pos:new V(Math.random()*1000,Math.random()*1000),mass:1,color:'#f'+Math.floor(Math.random()*16).toString(16)+0})}
function loop(){u();r();requestAnimationFrame(loop)}loop();
</script>
</body>
</html>
